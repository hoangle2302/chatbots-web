<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th∆∞ Vi·ªán AI Chatbot Web</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Sidebar ch·ªçn model -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>
                <span>üß†</span><span> </span>
                <span>T</span><span>h</span><span>∆∞</span><span> </span>
                <span>V</span><span>i</span><span>·ªá</span><span>n</span><span> </span>
                <span>A</span><span>I</span>
            </h2>
            <div class="user-section" id="user-section" style="display: none;">
                <div class="user-info">
                    <span id="user-name">User</span>
                    <span id="user-credits" class="credits">0 credits</span>
                </div>
                <div class="user-actions">
                    <a href="dashboard.html" class="btn-dashboard">Dashboard</a>
                    <a href="pricing.html" class="btn-pricing">N·∫°p credits</a>
                    <button onclick="logout()" class="btn-logout">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>
            <div class="auth-section" id="auth-section">
                <a href="login.html" class="btn-login">ƒêƒÉng nh·∫≠p</a>
                <a href="register.html" class="btn-register">ƒêƒÉng k√Ω</a>
            </div>
        </div>
        <label for="model-select">Ch·ªçn m√¥ h√¨nh:</label>
        <select id="model-select">
            <option value="ensemble">ü§ñ T·∫•t c·∫£ AI (Ensemble)</option>
            <option value="o3-mini">1. OpenAI o3-mini</option>
            <option value="o3">2. OpenAI o3</option>
            <option value="GPT-4O">3. GPT-4O</option>
            <option value="gpt-4-turbo">4. GPT-4 Turbo</option>
            <option value="gemini-2-5-pro">5. Gemini 2.5 Pro</option>
            <option value="gemini-pro">6. Gemini Pro 1.5</option>
            <option value="gemini-ultra">7. Gemini Ultra</option>
            <option value="claude-3-5-sonnet">8. Claude 3.5 Sonnet</option>
            <option value="claude-3-5-haiku">9. Claude 3.5 Haiku</option>
            <option value="claude-3-opus">10. Claude 3 Opus</option>
            <option value="grok-2">11. Grok-2</option>
            <option value="grok-2-mini">12. Grok-2 Mini</option>
            <option value="llama-3-3-70b">13. Llama 3.3 70B</option>
            <option value="llama-3-1-405b">14. Llama 3.1 405B</option>
            <option value="qwen-2-5-72b">15. Qwen 2.5 72B</option>
            <option value="qwen-2-5-coder">16. Qwen 2.5 Coder</option>
            <option value="deepseek-v3">17. DeepSeek-V3</option>
            <option value="deepseek-coder">18. DeepSeek Coder V2</option>
            <option value="mistral-large">19. Mistral Large 2</option>
            <option value="mistral-nemo">20. Mistral Nemo</option>
            <option value="yi-large">21. Yi-Large</option>alo
            Arctic</option>
            <option value="wizardlm-2">26. WizardLM-2</option>
            <option value="solar-pro">27. Solar Pro</option>
            <option value="mixtral-8x22b">28. Mixtral 8x22B</option>
        </select>
        <!-- Upload t√†i li·ªáu -->
        <div class="document-section">
            <h3>üìÑ T√†i li·ªáu</h3>
            <button id="manage-docs-btn" class="manage-docs-button">üìö Qu·∫£n l√Ω t√†i li·ªáu</button>
            <input type="file" id="document-upload" accept=".pdf,.doc,.docx,.xls,.xlsx,.txt" style="display:none">
            <button id="upload-btn" class="upload-button">üìé T·∫£i nhanh</button>
            <div id="document-info" class="document-info" style="display:none">
                <p id="doc-name"></p>
                <button id="remove-doc" class="remove-doc">‚ùå X√≥a</button>
            </div>
        </div>

        <!-- Ch·∫ø ƒë·ªô x·ª≠ l√Ω -->
        <div class="processing-mode">
            <h3>‚öôÔ∏è Ch·∫ø ƒë·ªô x·ª≠ l√Ω</h3>
            <label>
                <input type="radio" name="processing-mode" value="single" checked>
                <span>ƒê∆°n l·∫ª (1 AI)</span>
            </label>
            <label>
                <input type="radio" name="processing-mode" value="ensemble">
                <span>Ensemble (4 AI h√†ng ƒë·∫ßu)</span>
            </label>
            <label>
                <input type="radio" name="processing-mode" value="distributed">
                <span>üöÄ Ph√¢n t√°n (28 AI ph√¢n c√¥ng)</span>
            </label>
        </div>

        <div class="mode-info">
            <p><strong>Ch·∫ø ƒë·ªô Ph√¢n t√°n:</strong></p>
            <p>28 AI s·∫Ω ph√¢n c√¥ng nhi·ªám v·ª• th√¥ng minh: AI m·∫°nh x·ª≠ l√Ω vi·ªác n·∫∑ng, AI kh√°c ki·ªÉm duy·ªát v√† ho√†n thi·ªán!</p>
        </div>
        <footer>¬© Th∆∞ Vi·ªán AI</footer>
    </aside>
    <!-- Khu v·ª±c chat -->
    <main class="chat-container">
        <header class="chat-header">
            <span>Tr·ª£ l√Ω AI trong c√¥ng vi·ªác</span>
            <span id="loading" class="loading" style="display:none">ƒêang x·ª≠ l√Ω...</span>
        </header>
        <section id="chat-area" class="chat-area">
            <!-- Tin nh·∫Øn s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
        </section>
        <!-- Progress bar cho ch·∫ø ƒë·ªô ph√¢n t√°n -->
        <div id="progress-container" class="progress-container" style="display:none">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <p id="progress-text">ƒêang x·ª≠ l√Ω...</p>
        </div>

        <form id="chat-form" class="chat-form">
            <input type="text" id="chat-input" placeholder="Nh·∫≠p tin nh·∫Øn ho·∫∑c h·ªèi v·ªÅ t√†i li·ªáu..." autocomplete="off"
                required />
            <button type="submit" id="send-btn">G·ª≠i</button>
        </form>
    </main>
    <!-- Th∆∞ vi·ªán x·ª≠ l√Ω t√†i li·ªáu -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Scripts c·ªßa ·ª©ng d·ª•ng -->
    <script src="config.js?v=3"></script>
    <script src="script-backend.js?v=3"></script>
    
    <!-- Script qu·∫£n l√Ω tr·∫°ng th√°i ƒëƒÉng nh·∫≠p -->
    <script>
        // Ki·ªÉm tra tr·∫°ng th√°i ƒëƒÉng nh·∫≠p khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
        });

        function checkLoginStatus() {
            const userData = localStorage.getItem('user');
            const authSection = document.getElementById('auth-section');
            const userSection = document.getElementById('user-section');
            
            if (userData) {
                // User ƒë√£ ƒëƒÉng nh·∫≠p
                try {
                    const user = JSON.parse(userData);
                    
                    // ·∫®n section ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω
                    if (authSection) {
                        authSection.style.display = 'none';
                    }
                    
                    // Hi·ªán section user
                    if (userSection) {
                        userSection.style.display = 'block';
                        
                        // C·∫≠p nh·∫≠t th√¥ng tin user
                        const userNameElement = document.getElementById('user-name');
                        const userCreditsElement = document.getElementById('user-credits');
                        
                        if (userNameElement) {
                            userNameElement.textContent = user.username || 'User';
                        }
                        
                        if (userCreditsElement) {
                            userCreditsElement.textContent = (user.credits || 0) + ' credits';
                        }
                    }
                } catch (error) {
                    console.error('Error parsing user data:', error);
                    // N·∫øu c√≥ l·ªói, hi·ªÉn th·ªã l·∫°i section ƒëƒÉng nh·∫≠p
                    showAuthSection();
                }
            } else {
                // User ch∆∞a ƒëƒÉng nh·∫≠p
                showAuthSection();
            }
        }

        function showAuthSection() {
            const authSection = document.getElementById('auth-section');
            const userSection = document.getElementById('user-section');
            
            if (authSection) {
                authSection.style.display = 'block';
            }
            
            if (userSection) {
                userSection.style.display = 'none';
            }
        }

        function logout() {
            // X√≥a d·ªØ li·ªáu user kh·ªèi localStorage
            localStorage.removeItem('user');
            localStorage.removeItem('token');
            
            // Hi·ªÉn th·ªã l·∫°i section ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω
            showAuthSection();
            
            // Th√¥ng b√°o ƒëƒÉng xu·∫•t th√†nh c√¥ng
            alert('ƒêƒÉng xu·∫•t th√†nh c√¥ng!');
            
            // Reload trang ƒë·ªÉ ƒë·∫£m b·∫£o tr·∫°ng th√°i ƒë∆∞·ª£c c·∫≠p nh·∫≠t
            window.location.reload();
        }

        // L·∫Øng nghe s·ª± ki·ªán storage ƒë·ªÉ c·∫≠p nh·∫≠t khi ƒëƒÉng nh·∫≠p t·ª´ tab kh√°c
        window.addEventListener('storage', function(e) {
            if (e.key === 'user') {
                checkLoginStatus();
            }
        });
    </script>
</body>

</html>
